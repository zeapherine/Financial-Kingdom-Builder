version: '3.8'

services:
  # API Gateway
  api-gateway:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: api-gateway
        PORT: 3000
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=development
      - TRADING_SERVICE_URL=http://trading-service:3001
      - GAMIFICATION_SERVICE_URL=http://gamification-service:3002
      - EDUCATION_SERVICE_URL=http://education-service:3003
      - SOCIAL_SERVICE_URL=http://social-service:3004
      - NOTIFICATION_SERVICE_URL=http://notification-service:3005
      - JWT_SECRET=dev-secret-change-in-production
    depends_on:
      - trading-service
      - gamification-service
      - education-service
      - social-service
      - notification-service
    networks:
      - financial-kingdom-network

  # Trading Service
  trading-service:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: trading
        PORT: 3001
    ports:
      - "3001:3001"
    environment:
      - NODE_ENV=development
      - PORT=3001
    networks:
      - financial-kingdom-network

  # Gamification Service
  gamification-service:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: gamification
        PORT: 3002
    ports:
      - "3002:3002"
    environment:
      - NODE_ENV=development
      - PORT=3002
    networks:
      - financial-kingdom-network

  # Education Service
  education-service:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: education
        PORT: 3003
    ports:
      - "3003:3003"
    environment:
      - NODE_ENV=development
      - PORT=3003
    networks:
      - financial-kingdom-network

  # Social Service
  social-service:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: social
        PORT: 3004
    ports:
      - "3004:3004"
    environment:
      - NODE_ENV=development
      - PORT=3004
    networks:
      - financial-kingdom-network

  # Notification Service
  notification-service:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        SERVICE_NAME: notifications
        PORT: 3005
    ports:
      - "3005:3005"
    environment:
      - NODE_ENV=development
      - PORT=3005
    networks:
      - financial-kingdom-network

networks:
  financial-kingdom-network:
    driver: bridge

volumes:
  postgres_data:
  redis_data:
  mongodb_data: